<!DOCTYPE html>
<html lang="en">

<!-- 
Ann Maria Jiji
2227522
DISM2B04 
-->

<!--
    References:
    Photo by <a href="https://unsplash.com/@alexxsvch?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Alexey Savchenko</a> on <a href="https://unsplash.com/photos/k4Akpt5-Sfk?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a>
  
-->


<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    
  
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    
    <!-- Javascripts   Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"></script>
  
    <title>SP Games</title>
    <link rel="stylesheet" href="./css/commonStyles.css">
    <link rel="stylesheet" href="./css/imagesStyles.css">
    <link rel="stylesheet" href="./css/searchBox.css">
    
</head>

<!----------------------------------------------------------------------------------------------------------------------------------------------------------->

<body>
    <div class="main-container">
        <!-- Navbar -->
      <nav class="navbar navbar-expand-lg" id="custom-navbar">
        <div id="brand">
          <a><i class="bi bi-joystick"></i>SP Games</a>
        </div>
  
        <div class="d-flex" id="elements">
          <a class="nav-link flex-fill" href="index.html">Home</a>
          <a class="nav-link flex-fill" href="#">Games</a>
          <a class="nav-link flex-fill" href="#">About</a>
          <a class="nav-link flex-fill" href="#">Contact</a>
          <button class="btn btn-primary flex-fill" id="button" onclick="window.location.href='login.html'">Login</button>
        </div>
      </nav>

        <div id="details-container">
            <!-- use js function to create -->
        </div>
        
        <div id="review-container">
            <!-- use js function to create -->
        </div>


    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous">
    </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  
  <!-- JS code -->

  <script>
    // fix base Url
    const baseUrl = "http://localhost:3000";

    document.addEventListener("DOMContentLoaded", function() {
        const params = new URLSearchParams(window.location.search);
        const gameTitle = params.get('gameTitle');
        const platformID = params.get('platformID');
        const categoryID = params.get('platformID');
        const gameid = params.get('gameid');

        const query = `search?gameTitle=${gameTitle}&platformID=${platformID}&categoryID=${categoryID}`
        
        // DISPLAYING 
        let gameDetailsContainer = null;

        // funtion to create display for details
        function createDetails(game) {
            const detailCard = document.createElement('div');
            detailCard.classList.add("game-details");

            const cardContent = `
            <div class="game-image">
                <img src="${baseUrl}/images/${game.image}" alt="Game Image">
            </div>
            <div class="game-content">
                <h3 class="game-title">${game.title}</h3>
                <p class="game-description">${game.description}</p>
                <p class="game-price">Price: $${game.price}</p>
                <p class="game-year">Release Year: ${game.year}</p>
                <p class="game-platform">Platform: ${game.platform}</p>
                <p class="game-category">Category: ${game.category}</p>
            </div>
            `;

            detailCard.innerHTML = cardContent;
            return detailCard;
        }

        // function to display game details in the container
        function displayGameDetails(game) {
            const gameDetailsContainer = document.getElementById("details-container");
            const gameDetails = createDetails(game);
            gameDetailsContainer.appendChild(gameDetails);
        }
       
        
        // REVIEWS
        let reviewContainer = null;

        // funtion to create display for details
        function createReviews(review) {
            const reviewCard = document.createElement('div');
            reviewCard.classList.add("review-details");

            const cardContent = `
            <div class="user-review">
                <p class="user-name">${review.username}</p>
                <p class="user-rating">Rating: ${review.rating}/5</p>
                <p class="content">${review.content}</p>
            `;

            reviewCard.innerHTML = cardContent;
            return reviewCard;
        }

        // function to display reviews in the container
        function displayReviews(review) {
            const reviewContainer = document.getElementById("review-container");
            const reviewDetails = createDetails(review);
            reviewContainer.appendChild(reviewDetails);
        } 
        
        
        // send to backend to get details
        axios.get(`${baseUrl}/${query}`)

            // handling successful responses
            .then((response) => {
                const data = response.data[0];
                console.log(data);

                // get the container element where game details will be added
                gameDetailsContainer = document.getElementById("game-details")

                displayGameDetails(data);
            })


        // // send to backend to get reviews
        // axios.get(`${baseUrl}/review/${gameid}`)

        //     // handling successful responses
        //     .then((response) => {
        //         const data = response.data[0];
        //         console.log(data);

        //         // get the container element where game details will be added
        //         reviewContainer = document.getElementById("review-details");

        //         displayReviews(data);
        //     })
        
    })
  </script>
</body>